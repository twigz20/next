define("text",["module"],function(e){"use strict";var t,n,o,i,r,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,u=d&&location.protocol&&location.protocol.replace(/\:/,""),c=d&&location.hostname,f=d&&(location.port||void 0),p={},m=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(l,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(o){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,o,i=!1,r=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!a||r>1)?(t=e.substring(0,r),n=e.substring(r+1,e.length)):t=e,o=n||t,r=o.indexOf("!"),-1!==r&&(i="strip"===o.substring(r+1),o=o.substring(0,r),n?n=o:t=o),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,o,i){var r,a,l,s=t.xdRegExp.exec(e);return s?(r=s[2],a=s[3],a=a.split(":"),l=a[1],a=a[0],!(r&&r!==n||a&&a.toLowerCase()!==o.toLowerCase()||(l||a)&&l!==i)):!0},finishLoad:function(e,n,o,i){o=n?t.strip(o):o,m.isBuild&&(p[e]=o),i(o)},load:function(e,n,o,i){if(i.isBuild&&!i.inlineText)return void o();m.isBuild=i.isBuild;var r=t.parseName(e),a=r.moduleName+(r.ext?"."+r.ext:""),l=n.toUrl(a),s=m.useXhr||t.useXhr;return 0===l.indexOf("empty:")?void o():void(!d||s(l,u,c,f)?t.get(l,function(n){t.finishLoad(e,r.strip,n,o)},function(e){o.error&&o.error(e)}):n([a],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,o)}))},write:function(e,n,o,i){if(p.hasOwnProperty(n)){var r=t.jsEscape(p[n]);o.asModule(e+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,n,o,i,r){var a=t.parseName(n),l=a.ext?"."+a.ext:"",s=a.moduleName+l,d=o.toUrl(a.moduleName+l)+".js";t.load(s,o,function(n){var o=function(e){return i(d,e)};o.asModule=function(e,t){return i.asModule(e,d,t)},t.write(e,s,o,r)},r)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,o){try{var i=n.readFileSync(e,"utf8");0===i.indexOf("\ufeff")&&(i=i.substring(1)),t(i)}catch(r){o(r)}}):"xhr"===m.env||!m.env&&t.createXhr()?t.get=function(e,n,o,i){var r,a=t.createXhr();if(a.open("GET",e,!0),i)for(r in i)i.hasOwnProperty(r)&&a.setRequestHeader(r.toLowerCase(),i[r]);m.onXhr&&m.onXhr(a,e),a.onreadystatechange=function(t){var i,r;4===a.readyState&&(i=a.status,i>399&&600>i?(r=new Error(e+" HTTP status: "+i),r.xhr=a,o(r)):n(a.responseText),m.onXhrComplete&&m.onXhrComplete(a,e))},a.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,o,i="utf-8",r=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),l=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),i)),s="";try{for(n=new java.lang.StringBuffer,o=l.readLine(),o&&o.length()&&65279===o.charAt(0)&&(o=o.substring(1)),null!==o&&n.append(o);null!==(o=l.readLine());)n.append(a),n.append(o);s=String(n.toString())}finally{l.close()}t(s)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in o,t.get=function(e,t){var n,a,l,s={};r&&(e=e.replace(/\//g,"\\")),l=new FileUtils.File(e);try{n=o["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(l,1,0,!1),a=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),a.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),s),a.close(),n.close(),t(s.value)}catch(d){throw new Error((l&&l.path||"")+": "+d)}}),t}),define("text!htmlContent/upload-files-dialog.html",[],function(){return'<div class="upload-files-dialog modal">\n  <div class="modal-header">\n    <h1 class="dialog-title">{{ UPLOAD_FILES_DIALOG_HEADER }}</h1>\n  </div>\n\n  <div class="modal-body">\n    <div class="drag-files-area">\n      <div class="drag-instructions">\n        {{ DRAG_AREA_UPLOAD_FILES_DIALOG_TEXT }}\n      </div>\n      <div class="drop-instructions">\n        {{ DROP_AREA_UPLOAD_FILES_DIALOG_TEXT }}\n      </div>\n\n      <div class="drop-zone"></div>\n    </div>\n\n\t<div class="uploading-files">\n\t  <div class="upload-indicator">\n\t    <h3 class="title">{{ UPLOADING_INDICATOR }}</h3>\n\t    <div class="upload-spinner">\n\t      <div class="circle"></div>\n\t      <div class="mask"></div>\n\t    </div>\n\t  </div>\n    </div>\n\n  </div>\n  <div class="modal-footer">\n    <button class="dialog-button btn primary" data-button-id="from-computer">{{ BUTTON_FROM_YOUR_COMPUTER }}</button>\n    <button class="dialog-button btn" data-button-id="take-selfie">{{ TAKE_A_SELFIE }}</button>\n    <button class="dialog-button btn" data-button-id="cancel">{{ CANCEL }}</button>\n  </div>\n</div>\n\n'}),define("UploadFilesDialog",["require","exports","module","text!htmlContent/upload-files-dialog.html"],function(e,t,n){"use strict";function o(){$(".upload-files-input-elem")[0]||$(document.body).append($('<input class="upload-files-input-elem" type="file" multiple />'))}function i(){this.fileInput=new o,this.deferred=new $.Deferred}function r(){return a?a.deferred.promise():(a=new i,a.show())}var a=null,l=brackets.getModule("bramble/StartupState"),s=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,d=brackets.getModule("command/CommandManager"),u=brackets.getModule("command/Commands").CMD_OPEN,c=brackets.getModule("widgets/Dialogs"),f=brackets.getModule("utils/DragAndDrop"),p=brackets.getModule("utils/KeyEvent"),m=brackets.getModule("strings"),g=brackets.getModule("thirdparty/mustache/mustache"),v=e("text!htmlContent/upload-files-dialog.html"),h=function(e){return!!(e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia)}(window.navigator);o.prototype.getFiles=function(){return this.getElem$()[0].files},o.prototype.getElem$=function(){return $(".upload-files-input-elem")},o.prototype.remove=function(){this.getElem$().remove()},i.prototype.show=function(){var e=this,t=e.deferred;c.showModalDialogUsingTemplate(g.render(v,m),!1);var n=$(".upload-files-dialog.instance"),o=n.find(".drag-files-area"),i=n.find(".uploading-files"),r=n.find(".dialog-button[data-button-id='from-computer']"),a=n.find(".dialog-button[data-button-id='take-selfie']"),l=n.find(".dialog-button[data-button-id='cancel']"),s=n.find(".drop-zone");return h||a.attr("disabled",!0),i.hide(),r.one("click",e._handleFromComputer.bind(e)),a.one("click",e._handleTakeSelfie.bind(e)),l.one("click",function(){e.hide(),e.destroy()}),$(window.document.body).on("keyup.installDialog",e._handleKeyUp.bind(e)),f.attachHandlers({elem:s[0],ondragover:function(){e._dragover||(e._dragover=!0,o.addClass("drag-over"))},ondragleave:function(){delete e._dragover,o.removeClass("drag-over")},ondrop:function(){r.off("click",e._handleFromComputer.bind(e)),a.off("click",e._handleTakeSelfie.bind(e)),e.hide()},onfilesdone:function(){e.destroy()},autoRemoveHandlers:!0}),t.promise()},i.prototype._handleKeyUp=function(e){var t=this;e.keyCode===p.DOM_VK_ESCAPE&&(t.hide(),t.destroy(),t.deferred.resolve())},i.prototype._handleTakeSelfie=function(){var e=this,t=e.deferred;e.hide(),e.destroy(),d.execute("bramble.selfie").done(function(e){e=s.join(l.project("root"),e),d.execute(u,{fullPath:e}).then(t.resolve,t.reject)}).fail(t.reject)},i.prototype._handleFromComputer=function(){function e(e){var o=t.fileInput.getFiles();f.processFiles(o,function(e){t.destroy(),e?n.reject():n.resolve()})}var t=this,n=t.deferred;t.hide(),a=null;var o=t.fileInput.getElem$();o.on("change",e),o.click()},i.prototype.hide=function(){var e=this;$(window.document.body).off("keyup.installDialog",e._handleKeyUp),c.cancelModalDialogIfOpen("upload-files-dialog")},i.prototype.destroy=function(){a=null,this.fileInput.remove()},t.show=r}),define("main",["require","exports","module","UploadFilesDialog"],function(e,t,n){"use strict";function o(){return l.getEnforceLimits()?r.execute("bramble.projectSizeError"):s.show()}function i(){r.register(d,u,o)}var r=brackets.getModule("command/CommandManager"),a=brackets.getModule("utils/ExtensionUtils"),l=brackets.getModule("filesystem/impls/filer/lib/Sizes"),s=e("UploadFilesDialog"),d="Show Upload Files Dialog",u="bramble.showUploadFiles";a.loadStyleSheet(n,"styles.less"),i()});